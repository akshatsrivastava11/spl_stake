
# SPL Mock Staking Program

This project is a **Solana smart contract** (built with [Anchor](https://book.anchor-lang.com/)) that implements a **basic staking mechanism** using mock SPL tokens.
It provides functionality for:

* Initializing a staking pool
* Depositing tokens into the pool
* Withdrawing staked tokens

---

## ğŸ“‚ Project Structure

```
.
â”œâ”€â”€ programs/
â”‚   â””â”€â”€ spl_mock/           # Anchor program written in Rust
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ lib.rs      # Program entrypoints
â”‚       â”‚   â”œâ”€â”€ instructions/ # Instruction handlers
â”‚       â”‚   â””â”€â”€ state/      # Account state definitions
â”‚       â””â”€â”€ Cargo.toml
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ spl_mock.ts         # Mocha/TypeScript tests
â”œâ”€â”€ target/                 # Build artifacts (generated)
â”œâ”€â”€ Anchor.toml             # Anchor configuration
â”œâ”€â”€ Cargo.toml              # Rust workspace config
â””â”€â”€ README.md               # Documentation
```

---

## âš™ï¸ Features

* **StakingPool account** â€“ Stores global staking pool state:

  * Authority
  * Staking mint
  * Vault account
  * Total staked tokens
* **UserStaking account** â€“ Tracks each userâ€™s staked amount and token account.

### Instructions

1. **InitializeStakingPool**

   * Creates the pool PDA
   * Initializes staking mint & vault

2. **Deposit**

   * Creates a `UserStaking` PDA for the user
   * Transfers tokens from user to vault

3. **Withdraw**

   * Transfers tokens back from vault to user
   * Closes user staking account

---

## ğŸš€ Getting Started

### Prerequisites

* [Rust](https://www.rust-lang.org/tools/install)
* [Solana CLI](https://docs.solana.com/cli/install-solana-cli)
* [Anchor](https://book.anchor-lang.com/getting_started/installation.html)
* [Node.js](https://nodejs.org/) (for tests)

---

### Build

```bash
anchor build
```

### Run Tests

```bash
npm i @solana/web3.js
npm i @solana/spl-token
anchor test
```

This will:

* Deploy the program locally
* Run the provided TypeScript tests (`tests/spl_mock.ts`)
* Simulate deposit/withdraw functionality

---

## ğŸ§ª Example Test Flow

In `tests/spl_mock.ts`, the test script does:

1. **Airdrops SOL** to the test users and mint authority
2. **Creates a mint** and mints tokens to the user
3. **Transfers mint authority** to the staking pool PDA
4. Calls:

   * `initializeStakingPool`
   * `deposit(amount)`
   * `withdraw()`

---

